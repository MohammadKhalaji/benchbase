-- DDL from the SSB paper:
-- https://www.cs.umb.edu/~poneil/StarSchemaB.PDF

DROP TABLE IF EXISTS DATE CASCADE;

DROP TABLE IF EXISTS CUSTOMER CASCADE;

DROP TABLE IF EXISTS SUPPLIER CASCADE;

DROP TABLE IF EXISTS PART CASCADE;

DROP TABLE IF EXISTS LINEORDER CASCADE;

-- DATE TABLE
CREATE TABLE DATE (
    D_DATEKEY integer NOT NULL,
    D_DATE char(18) NOT NULL,
    D_DAYOFWEEK char(8) NOT NULL,
    D_MONTH char(9) NOT NULL,
    D_YEAR smallint NOT NULL,
    D_YEARMONTHNUM smallint NOT NULL,
    D_YEARMONTH char(7) NOT NULL,
    D_DAYNUMINWEEK smallint NOT NULL,
    D_DAYNUMINMONTH smallint NOT NULL,
    D_DAYNUMINYEAR smallint NOT NULL,
    D_MONTHNUMINYEAR smallint NOT NULL,
    D_WEEKNUMINYEAR smallint NOT NULL,
    D_SELLINGSEASON char(12) NOT NULL,
    D_LASTDAYINWEEKFL bit(1) NOT NULL,
    D_LASTDAYINMONTHFL bit(1) NOT NULL,
    D_HOLIDAYFL bit(1) NOT NULL,
    D_WEEKDAYFL bit(1) NOT NULL,
    PRIMARY KEY (D_DATEKEY)
); 

 -- PART TABLE 
CREATE TABLE PART (
    P_PARTKEY integer NOT NULL,
    P_NAME varchar(22) NOT NULL,
    P_MFGR char(6) NOT NULL,
    P_CATEGORY char(7) NOT NULL,
    P_BRAND char(9) NOT NULL,
    P_COLOR varchar(11) NOT NULL,
    P_TYPE varchar(25) NOT NULL,
    P_SIZE smallint NOT NULL,
    P_CONTAINER char(10) NOT NULL,
    PRIMARY KEY (P_PARTKEY)
); 


-- SUPPLIER TABLE
CREATE TABLE SUPPLIER (
    S_SUPPKEY integer NOT NULL,
    S_NAME char(25) NOT NULL,
    S_ADDRESS varchar(25) NOT NULL,
    S_CITY char(10) NOT NULL,
    S_NATION_PREFIX char(1) NOT NULL,
    S_NATION char(15) NOT NULL,
    S_REGION char(12) NOT NULL,
    S_PHONE char(15) NOT NULL,
    PRIMARY KEY (S_SUPPKEY)
); 


-- CUSTOMER TABLE 
CREATE TABLE CUSTOMER (
    C_CUSTKEY integer NOT NULL,
    C_NAME varchar(25) NOT NULL,
    C_ADDRESS varchar(25) NOT NULL,
    C_CITY char(10) NOT NULL,
    C_NATION_PREFIX char(1) NOT NULL,
    C_NATION char(15) NOT NULL,
    C_REGION char(12) NOT NULL,
    C_PHONE char(15) NOT NULL,
    C_MKTSEGMENT char(10) NOT NULL,
    PRIMARY KEY (C_CUSTKEY)
); 


-- LINEORDER TABLE
CREATE TABLE LINEORDER (
    LO_ORDERKEY integer NOT NULL,
    LO_LINENUMBER smallint NOT NULL,
    LO_CUSTKEY integer NOT NULL,
    LO_PARTKEY integer NOT NULL,
    LO_SUPPKEY integer NOT NULL,
    LO_ORDERDATE integer NOT NULL,
    LO_ORDERPRIORITY char(15) NOT NULL,
    LO_SHIPPRIORITY char(1) NOT NULL,
    LO_QUANTITY smallint NOT NULL,
    LO_EXTENDEDPRICE INTEGER NOT NULL,
    LO_ORDTOTALPRICE INTEGER NOT NULL,
    LO_DISCOUNT smallint NOT NULL,
    LO_REVENUE INTEGER NOT NULL,
    LO_SUPPLYCOST INTEGER NOT NULL,
    LO_TAX smallint NOT NULL,
    LO_COMMITDATE integer NOT NULL,
    LO_SHIPMODE char(10) NOT NULL,

    FOREIGN KEY (LO_CUSTKEY) REFERENCES CUSTOMER (C_CUSTKEY) ON DELETE CASCADE,
    FOREIGN KEY (LO_PARTKEY) REFERENCES PART (P_PARTKEY) ON DELETE CASCADE,
    FOREIGN KEY (LO_SUPPKEY) REFERENCES SUPPLIER (S_SUPPKEY) ON DELETE CASCADE,
    FOREIGN KEY (LO_ORDERDATE) REFERENCES DATE (D_DATEKEY) ON DELETE CASCADE,
    FOREIGN KEY (LO_COMMITDATE) REFERENCES DATE (D_DATEKEY) ON DELETE CASCADE,
    PRIMARY KEY (LO_ORDERKEY, LO_LINENUMBER)
);