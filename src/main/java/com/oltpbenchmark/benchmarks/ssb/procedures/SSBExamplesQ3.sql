-- Q31 
SELECT C_NATION, S_NATION, D_YEAR, SUM(LO_REVENUE) as REVENUE
FROM CUSTOMER, LINEORDER, SUPPLIER, DATE
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_REGION = 'EUROPE' AND S_REGION = 'EUROPE' -- no fuss over being the same
AND D_YEAR >= 1992 AND D_YEAR <= 1997
GROUP BY C_NATION, S_NATION, D_YEAR
ORDER BY D_YEAR ASC, REVENUE DESC;

-- Q31, FF friendly
SELECT COUNT(*)
FROM CUSTOMER, LINEORDER, SUPPLIER, DATE
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_REGION = 'EUROPE' AND S_REGION = 'AFRICA' -- no fuss over being the same
AND D_YEAR >= 1992 AND D_YEAR <= 1997;

-- Q32
SELECT C_CITY, S_CITY, D_YEAR, SUM(LO_REVENUE) AS REVENUE
FROM CUSTOMER, LINEORDER, SUPPLIER, DATE
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_NATION = 'UNITED KINGDOM'
AND S_NATION = 'IRAN'
AND D_YEAR >= 1992 AND D_YEAR <= 1997
GROUP BY C_CITY, S_CITY, D_YEAR
ORDER BY D_YEAR ASC, REVENUE DESC;

-- Q32, FF friendly
SELECT COUNT(*)
FROM CUSTOMER, LINEORDER, SUPPLIER, DATE
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_NATION = 'IRAN'
AND S_NATION = 'IRAN' -- no fuss over being the same
AND D_YEAR >= 1992 AND D_YEAR <= 1997;

-- Q33
SELECT C_CITY, S_CITY, D_YEAR, SUM(LO_REVENUE) AS REVENUE
FROM CUSTOMER, LINEORDER, SUPPLIER, DATE
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_ORDERDATE = D_DATEKEY
AND (C_CITY = 'IRAN     1' OR C_CITY = 'IRAN     2') -- DO fuss over being from the same country. DO fuss over not being the same city
AND (S_CITY = 'IRAN     1' OR S_CITY = 'IRAN     2') -- DO NOT fuss over being the same cities as above
AND D_YEAR >= 1992 AND D_YEAR <= 1995
GROUP BY C_CITY, S_CITY, D_YEAR
ORDER BY D_YEAR ASC, REVENUE DESC;

-- Q33, FF friendly
SELECT COUNT(*)
FROM CUSTOMER, LINEORDER, SUPPLIER, DATE
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_ORDERDATE = D_DATEKEY
AND (C_CITY = 'IRAN     1' OR C_CITY = 'IRAN     2') -- DO fuss over being from the same country. DO fuss over not being the same city
AND (S_CITY = 'MOZAMBIQU4' OR S_CITY = 'MOZAMBIQU1') -- DO NOT fuss over being the same cities as above
AND D_YEAR >= 1992 AND D_YEAR <= 1995;


-- Q34 
SELECT C_CITY, S_CITY, D_YEAR, SUM(LO_REVENUE) AS REVENUE
FROM CUSTOMER, LINEORDER, SUPPLIER, DATE
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_ORDERDATE = D_DATEKEY
AND (C_CITY = 'IRAN     1' OR C_CITY = 'IRAN     2') -- DO fuss over being from the same country. DO fuss over not being the same city
AND (S_CITY = 'MOZAMBIQU4' OR S_CITY = 'MOZAMBIQU1') -- DO NOT fuss over being the same cities as above
AND D_YEARMONTH = 'Dec1994'
GROUP BY C_CITY, S_CITY, D_YEAR
ORDER BY D_YEAR ASC, REVENUE DESC;

-- Q34, FF friendly
SELECT COUNT(*)
FROM CUSTOMER, LINEORDER, SUPPLIER, DATE
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_ORDERDATE = D_DATEKEY
AND (C_CITY = 'IRAN     1' OR C_CITY = 'IRAN     2') -- DO fuss over being from the same country. DO fuss over not being the same city
AND (S_CITY = 'MOZAMBIQU4' OR S_CITY = 'MOZAMBIQU1') -- DO NOT fuss over being the same cities as above
AND D_YEARMONTH = 'Dec1994';