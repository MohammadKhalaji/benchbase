-- Q41 
SELECT D_YEAR, C_NATION, SUM(LO_REVENUE - LO_SUPPLYCOST) AS PROFIT
FROM DATE, CUSTOMER, SUPPLIER, PART, LINEORDER
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_PARTKEY = P_PARTKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_REGION = 'MIDDLE EAST'
AND S_REGION = 'MIDDLE EAST' -- no fuss over being the same
AND (P_MFGR = 'MFGR#4' OR P_MFGR = 'MFGR#5')
GROUP BY D_YEAR, C_NATION
ORDER BY D_YEAR, C_NATION;

-- Q41, FF friendly
SELECT COUNT(*)
FROM DATE, CUSTOMER, SUPPLIER, PART, LINEORDER
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_PARTKEY = P_PARTKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_REGION = 'MIDDLE EAST'
AND S_REGION = 'AMERICA' -- no fuss over being the same
AND (P_MFGR = 'MFGR#4' OR P_MFGR = 'MFGR#5'); 

-- Q42
SELECT D_YEAR, S_NATION, P_CATEGORY, SUM(LO_REVENUE - LO_SUPPLYCOST) AS PROFIT
FROM DATE, CUSTOMER, SUPPLIER, PART, LINEORDER
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_PARTKEY = P_PARTKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_REGION = 'MIDDLE EAST'
AND S_REGION = 'MIDDLE EAST' -- no fuss over being the same
AND (D_YEAR = 1992 OR D_YEAR = 1993)
AND (P_MFGR = 'MFGR#2' OR P_MFGR = 'MFGR#5')
GROUP BY D_YEAR, S_NATION, P_CATEGORY
ORDER BY D_YEAR, S_NATION, P_CATEGORY;

-- Q42, FF friendly
SELECT COUNT(*)
FROM DATE, CUSTOMER, SUPPLIER, PART, LINEORDER
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_PARTKEY = P_PARTKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_REGION = 'MIDDLE EAST'
AND S_REGION = 'EUROPE' -- no fuss over being the same
AND (D_YEAR = 1992 OR D_YEAR = 1993)
AND (P_MFGR = 'MFGR#2' OR P_MFGR = 'MFGR#5');

-- Q43
SELECT D_YEAR, S_CITY, P_BRAND, SUM(LO_REVENUE - LO_SUPPLYCOST) AS PROFIT
FROM DATE, CUSTOMER, SUPPLIER, PART, LINEORDER
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_PARTKEY = P_PARTKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_REGION = 'MIDDLE EAST'
AND S_NATION = 'UNITED KINGDOM' -- no fuss over nation having to be in the region
AND (D_YEAR = 1992 OR D_YEAR = 1993)
AND P_CATEGORY = 'MFGR#25'
GROUP BY D_YEAR, S_CITY, P_BRAND
ORDER BY D_YEAR, S_CITY, P_BRAND;

-- Q43, FF friendly
SELECT COUNT(*)
FROM DATE, CUSTOMER, SUPPLIER, PART, LINEORDER
WHERE LO_CUSTKEY = C_CUSTKEY
AND LO_SUPPKEY = S_SUPPKEY
AND LO_PARTKEY = P_PARTKEY
AND LO_ORDERDATE = D_DATEKEY
AND C_REGION = 'MIDDLE EAST'
AND S_NATION = 'UNITED KINGDOM' -- no fuss over nation having to be in the region
AND (D_YEAR = 1992 OR D_YEAR = 1993)
AND P_CATEGORY = 'MFGR#25';